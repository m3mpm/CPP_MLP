# CPP_MLP

Данный проект представляет собой реализацию нейронной сети для распознавания рукописных букв латинского алфавита.

### Part 1. Требования к проекту CPP_MLP

- Программа должна предоставлять возможность формировать и обучать модели нейронных сетей для классификации рукописных букв латинского алфавита
- Программа должна быть разработана на языке C++ стандарта C++17
- Код программы должен находиться в папке src
- Классы должны быть реализованы внутри пространства имен `cpp_mlp`

- Реализовать нейронную сеть _двумя_ способами:

  - в матричном виде (все слои представлены в виде матриц весов)
  - в графовом виде (каждый нейрон представляется в виде некоторого объекта узла, связанного с другими узлами по ссылкам)

- Нейронная сеть должена:

  - классифицировать изображения с рукописными буквами латинского алфавита
  - иметь **от 2 до 5** скрытых слоев
  - использовать сигмоидальную функцию активации для каждого скрытого слоя
  - иметь возможность обучаться на открытом датасете (например, EMNIST-letters представленным в директории src/resources/datasets). Отношение тестовой выборки к обучающей должно составлять _не больше 2:8_, т.е. тестовая выборка составляет не более 20% исходного датасета
  - показывать точность на тестовой выборке _выше 70 процентов_
  - обучаться с использованием метода обратного распространения ошибки
  - обучать нейронную сеть на тестовой выборке **запрещено**

- Программа должна быть реализована с использованием паттерна MVC, а также:

  - не должно быть кода бизнес-логики в коде представлений
  - не должно быть кода интерфейса в контроллере и в модели
  - контроллеры должны быть тонкими

- Подготовить unit-тесты c помощью библиотеки GTest для модулей, связанных с вычислениями

- Реализация с графическим пользовательским интерфейсом, на базе Qt GUI-библиотеки с API для C++17. Интерфейс программы должен предоставлять возможность:

  - запустить эксперимент на тестовой выборке или ее части, задаваемой дробным числом от 0 до 1 (где 0 - это пустая выборка - вырожденная ситуация, а 1 - вся тестовая выборка целиком). После выполнения эксперимента на экран должно быть выведена средняя точность (average accuracy), прецизионность (precision), полнота (recall), f-мера (f-measure) и общее затраченное время
  - загружать BMP-изображения (размер изображения может достигать 512x512) с буквами латинского алфавита и осуществлять их классификацию
  - рисовать двухцветные квадратные изображения от руки в отдельном окне
  - запускать процесс обучения в реальном времени для заданного пользователем количества эпох с выводом на экран контрольных значений ошибки для каждой эпохи обучения. Предусмотреть возможность составление отчета в виде графика изменения ошибки, посчитанной на тестовой выборке, для каждой эпохи обучения
  - запускать процесс обучения с применением кросс-валидации для заданного числа групп _k_
  - переключать реализацию нейронной сети (матричная или графовая)
  - переключать количество скрытых слоев нейронной сети (от 2 до 5)
  - сохранять в файл и загружать из файла веса нейронной сети

- Сборка программы должна быть настроена с помощью Makefile со стандартным набором целей для GNU-программ: all, install, uninstall, clean, tests
- Установка должна вестись в любой произвольный каталог

### Part 2. Результат

- Главное окно, вкладка рисование с подписью элементов интерфейса

![Главное окно, вкладка рисование с подписью элементов интерфейса](/images/ui_decript.png)

1. Переключатель вкладок полотна для рисования и графика обучения, переключение осуществляется кликом на соотвествующую вкладку.
2. Полотно для рисования букв с помощью движения курсора мыши с зажатой левой кнопкой мыши, очистка полотна осуществляется через клик правой кнопкой мыши.
3. Загрузка картинки, в формате BMP, с нарисованной буквой для дальнейшего распознания.
4. Распознание изображения на полотне при нажатии на клавишу, для распознания необходимо чтобы полотно было заполненно вручную или из загруженной картинки, для успешного распознания необходимо заранее загрузить веса.
5. Отображение ответа нейросети в виде отгаданной буквы
6. Выбор типа реализации нейросети на матрицах или графах
7. Выбор количества скрытых слоев нейросети
8. Загрузка и сохранение весов нейросети из файла, после нажатия на кнопку необходимо выбрать путь до файла при загрузке, или имя файла при сохранении.

- По умолчанию заранее подготовленные веса загружаются в зависимости от выбора количества внутренних слоев.
- Чекбокс "manual load" позволяет самостоятельно выбрать фаил для загрузки, необходимо выбирать файл с весами соответвующий количеству внутренних слоев.

![Окно выбора файла при загрузке весов](/images/load_weigth.png)

9. Кнопка загрузки датасета, работает аналогичным образом, есть возможность выбрать из 2 подготовленных файлов, либо выбрать фаил самостоятельно.
10. Блок кнопок отвечающих за: тренировку, тестирование, кросс-валидацию нейросети - по-умолчанию заблокированы, если не загружен датасет.

- Тренировка.

  - При клике на кнопку тренировки открывается отдельное окно с возможностью выбора количество эпох тренировки, после запуска есть возможность прервать процесс на кнопку остановить.

  ![Обучение сети, всплывающее окно](/images/learn.png)

  - В процессе работы обучение, состояние каждой эпохи можно видеть на прогресс-баре, и после каждой эпохи происходит тестирование, результат тестирования, в виде графика и значения метрик(под графиком) на текущей эпохе

  ![Обучение сети, главное окно, вкладка график](/images/graphic_view_learn.png)

- Тестирование.

  - При клике на кнопку тестирование открывается отдельное окно с возможностью выбора размера выборки для тестирования(от 0 до 1, где 0 это ничего, а 1 вся выборка), после запуска есть возможность прервать процесс на кнопку остановить. Также происходит отображение результатов в вкладке график.

  ![Тестирование сети](/images/testing.png)

- Кросс-валидация

  - При клике на кнопку кросс-валидация открывается отдельное окно с возможностью выбора количества групп(на какое количество будет разделяться датасет), после запуска есть возможность прервать процесс на кнопку остановить. Внизу окна есть статус-бар где отображается текущее состояние процесса. Также происходит отображение результатов в вкладке график.

  ![Кросс-валидация сети](/images/cross-valid.png)

- Распознавание рукописных букв латинского алфавита

  ![Распознавание](/images/recognition_letter.png)

- Загрузка BMP-изображения (размер изображения может достигать 512x512) с буквами латинского алфавита и осуществлять их классификацию

  - Загрузка изображения
    ![Загрузка картинки](/images/load_letter_image.png)

  - Распознавание букв латинского алфавита с картинки
    ![Распознавание буквы](/images/recongnition_letter_image.png)

авторы: \
Эдуард(общий backend, backend графовой и матричной реализации, user interface) \
Руслан(backend графовой реализации, user interface) \
Евгений(backend матричной реализации, user interface)
